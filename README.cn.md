<p align="center">
<h1 align="center">TimeCat</h1>
<h6 align="center">
A Magical Web Recorder ğŸ–¥ ç½‘é¡µå½•å±å™¨
</h6>
<h6 align="center">

![GitHub issues](https://img.shields.io/github/issues-raw/oct16/TimeCat) ![GitHub last commit](https://img.shields.io/github/last-commit/oct16/timecat) ![npm (tag)](https://img.shields.io/npm/v/timecatjs/latest)

<h6>

### é¡¹ç›®ç®€ä»‹

ä¸­æ–‡ | [English](./README.md)

TimeCat æ˜¯ä¸€å¥—ç½‘é¡µå½•å±çš„è§£å†³æ–¹æ¡ˆï¼Œåˆ©ç”¨å…¶ç‹¬ç‰¹çš„ç®—æ³•ï¼Œæä¾›è¶…é«˜æ€§èƒ½ï¼Œè¶…é«˜å‹ç¼©æ¯”çš„ç½‘é¡µæ— æŸå½•åˆ¶ã€‚å¯ä»¥å¹¿æ³›è¿ä½œäºç›‘æ§ç³»ç»Ÿï¼Œè¡Œä¸ºåˆ†æï¼Œæ¡ˆä¾‹å¤ç›˜ï¼Œè¿œç¨‹æ•™è‚²ï¼Œä½æµé‡è§†é¢‘ååŒç­‰åœºæ™¯

[ğŸ–¥ DEMO](https://oct16.github.io/TimeCat) Chromeæµè§ˆå™¨

### Progress
    06.07 Support Audio
    05.24 Beta 1.0.0 Released
    04.26 Live Mode    
    03.31 Add Chrome Plugin 

### Version 

![npm (tag)](https://img.shields.io/npm/v/timecatjs/latest)

###### Browsers Support

| [<img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/edge/edge_48x48.png" alt="Edge" width="24px" height="24px" />](http://godban.github.io/browsers-support-badges/)<br/>Edge | [<img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/firefox/firefox_48x48.png" alt="Firefox" width="24px" height="24px" />](http://godban.github.io/browsers-support-badges/)<br/>Firefox | [<img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/chrome/chrome_48x48.png" alt="Chrome" width="24px" height="24px" />](http://godban.github.io/browsers-support-badges/)<br/>Chrome | [<img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/safari/safari_48x48.png" alt="Safari" width="24px" height="24px" />](http://godban.github.io/browsers-support-badges/)<br/>Safari |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

### Installation

###### Using [NPM](https://www.npmjs.com/package/timecatjs)
```shell
$ npm i timecatjs -D
```

###### Import in Browser

Add script tags in your browser and use the global variable ``timecat``


- [jsDelivr](https://cdn.jsdelivr.net/npm/timecatjs@latest/lib/timecatjs.min.js) 
- [UNPKG](https://unpkg.com/timecatjs)

### Usage

###### Import SDK
```ts
// from module
import { record, replay } from 'timecatjs';

// from cdn
const { record, replay } = window.timecat
```

###### Record Data
```ts
// record page
interface RecordOptions {
    audio?: boolean // if your want record audio
    emitter?: (data: RecordData, db: IndexedDBOperator) => void
}

// default use IndexedDB to save records
const ctrl = record(RecordOptions)

// if you wanna send the records to server
const ctrl = record({
    emitter: (data, db) => fetch(<Server URL>, {
            body: JSON.stringify(data),
            method: 'POST',
            ContentType: 'application/json'
        })
})

// if you want stop record
ctrl.unsubscribe()
```
- [Record Example](https://github.com/oct16/TimeCat/blob/073c467afc644ce37e4f51937c28eb5000b2a92c/examples/todo.html#L258) 

###### Replay

```ts
// replay record
interface ReplayOptions {
    socketUrl?: string // if live mode
    proxy?: string // if cross domain
    autoplay?: boolean // autoplay when data loaded
}

replay(ReplayOptions)
```
- [Replay example](https://github.com/oct16/TimeCat/blob/4c91fe2e9dc3786921cd23288e26b421f6ea0848/examples/player.html#L14)


###### Export
```ts
// export html file
interface ExportOptions {
    scripts?: ScriptItem[] // inject script in html
    autoplay?: boolean // autoplay when data loaded
    audioExternal?: boolean // export audio as a file, default is inline
    dataExternal?: boolean // export data json as a file, default is inline
}
exportReplay(ExportOptions)
```

### API Documentation

[TYPEDOC](https://oct16.github.io/TimeCat/docs/globals.html)

### TimeCat -- ä¸å¯æ€è®®çš„Webå½•å±å™¨

å¦‚æœä½ çˆ±æ‰“æ¸¸æˆï¼Œä¸€å®šæ‰“è¿‡é­”å…½äº‰éœ¸3ï¼ˆæš´éœ²å¹´çºªğŸ¤£ï¼‰ï¼Œä½ ä¹Ÿè®¸ä¼šæ¸¸æˆå¯¼å‡ºçš„å½•åƒæ–‡ä»¶æ„Ÿåˆ°å¥½å¥‡ï¼Œæ˜æ˜æ‰“äº†ä¸€ä¸ªå°æ—¶æ¸¸æˆï¼Œä¸ºä»€ä¹ˆå½•åƒæ‰å‡ ç™¾KBè€Œå·²ã€‚ä¸è¿‡å¾ˆå¿«ä½ åˆå‘ç°å¦ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨æ¯æ¬¡å¯¼å…¥å½•åƒçš„æ—¶å€™éœ€è¦é‡æ–°åŠ è½½ä¸€æ¬¡åœ°å›¾ï¼Œå¦åˆ™å°±ä¸èƒ½æ’­æ”¾ã€‚


å½•åƒè®°å½•çš„æ•°æ®ä¸æ˜¯ä¸€ä¸ªè§†é¢‘æ–‡ä»¶ï¼Œè€Œæ˜¯å¸¦ç€æ—¶é—´æˆ³çš„ä¸€ç³»åˆ—åŠ¨ä½œï¼Œå¯¼å…¥åœ°å›¾çš„æ—¶å€™ï¼Œå®é™…ç›¸å½“äºåˆå§‹äº†ä¸€ä¸ªçŠ¶æ€ï¼Œåœ¨è¿™ä¸ªçŠ¶æ€çš„åŸºç¡€ä¸Šï¼Œåªéœ€è¦å¯¹ä¹‹å‰çš„åŠ¨ä½œè¿›è¡Œè¿˜åŸï¼Œä¹Ÿå°±è¿˜åŸäº†ä¹‹å‰çš„æ¸¸æˆè¿‡ç¨‹ï¼Œè¿™å°±æ˜¯replçš„åŸºæœ¬åŸç†äº†

> ç›¸å…³é—®é¢˜ï¼š[ã€Šé­”å…½äº‰éœ¸ã€‹çš„å½•åƒï¼Œä¸ºä»€ä¹ˆé•¿è¾¾åŠå°æ—¶çš„å½•åƒå¤§å°åªæœ‰å‡ ç™¾ KBï¼Ÿ](https://www.zhihu.com/question/25431134)


ä½†æ˜¯è¿™æ ·æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ

é¦–å…ˆæ˜¯å¯¹äºä¸€ä¸ªå½•åƒï¼Œè¿™æ ·çš„æ–¹å¼æå¤§ç¨‹åº¦çš„å‡å°äº†ä½“ç§¯ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦å½•ä¸€ä¸ªå°æ—¶çš„1080p24fè§†é¢‘ï¼Œåœ¨è§†é¢‘æœªå‹ç¼©çš„æƒ…å†µä¸‹
```
æ€»å¸§æ•° = 3600s * 24 = 86400frame

å‡è®¾æ¯ä¸ªé€»è¾‘åƒç´ ç”¨RGBä¸‰åŸºè‰²è¡¨ç¤ºï¼Œæ¯ä¸ªåŸºè‰²8bits(256è‰²)   
å¸§å¤§å° = (1920 * 1080)pixels * 8bits * 3 = 49766400bits

æ¢ç®—æˆKBæ˜¯ 49766400bits / 8 / 1024 = 6075KB

æ€»è§†é¢‘ä½“ç§¯ = 6075KB * 86400 = 524880000KB â‰ˆ 500GB
```

æ‰€ä»¥å¯¹æ¯”ä¼ ç»Ÿçš„è§†é¢‘å½•åƒæ–¹æ³•ï¼Œå‡è®¾å½•åƒæ˜¯500KBï¼Œé‚£ä¹ˆç†è®ºä¸Šä½“ç§¯ä¸Šç¼©å°äº†å¤§çº¦ 524880000KB / 500KB â‰ˆ 1000000å€

Webå½•å±å™¨å…¶å®ä¹Ÿå€Ÿé‰´è¿™æ ·çš„ä¸€ç§æ€è·¯ï¼Œå·¥ç¨‹ä¸Šä¸€èˆ¬ç§°ä¹‹ä¸ºOperations Log, æœ¬è´¨ä¸Šä»–çš„å®ç°ä¹Ÿæ˜¯é€šè¿‡è®°å½•ä¸€ç³»åˆ—çš„æµè§ˆå™¨äº‹ä»¶æ•°æ®ï¼Œåˆ©ç”¨æµè§ˆå™¨å¼•æ“é‡æ–°æ¸²æŸ“ï¼Œè¿˜åŸäº†ä¹‹å‰çš„æ“ä½œè¿‡ç¨‹ï¼Œä¹Ÿå°±è¾¾åˆ°äº†â€œå½•å±å™¨â€çš„æ•ˆæœ

ä»å®é™…æ¥çœ‹ï¼Œå³ä½¿å¯¹æ¯”é‡‡ç”¨H.265å‹ç¼©æ¯”è¾¾åˆ°å‡ ç™¾å€çš„å‹ç¼©è§†é¢‘ï¼Œä½“ç§¯ä¸Šè‡³å°‘ä¹Ÿèƒ½èŠ‚çœ200å€ä»¥ä¸Š

å¯¹æ¯”ä¼ ç»Ÿçš„è§†é¢‘æµï¼Œå®ƒçš„ä¼˜åŠ¿ä¹Ÿæ˜¯æ˜¾è€Œæ˜“è§çš„

    1. æå¤§ç¨‹åº¦å‡å°å½•åƒæ–‡ä»¶ä½“ç§¯
    2. æä½çš„CPUä¸å†…å­˜å ç”¨æ¯”ç‡
    3. æ— æŸæ˜¾ç¤ºï¼Œå¯ä»¥è¿›è¡Œæ— æç¼©æ”¾ï¼Œçª—å£è‡ªé€‚åº”ç­‰
    4. éå¸¸çµæ´»çš„æ—¶é—´è·³è½¬ï¼Œå‡ ä¹æ— æ³•æ„ŸçŸ¥çš„ç¼“å†²æ—¶é—´
    5. æ‰€æœ‰ä¿¡æ¯éƒ½æ˜¯æ´»çš„ï¼Œæ–‡æœ¬å›¾ç‰‡å¯ä»¥å¤åˆ¶ï¼Œé“¾æ¥å¯ä»¥ç‚¹å‡»ï¼Œé¼ æ ‡å¯ä»¥æ»šåŠ¨
    6. å¯ä»¥æ–¹ä¾¿çš„å½•åˆ¶å£°éŸ³ï¼Œå¹¶è®©å£°éŸ³å’Œç”»é¢åŒæ­¥ï¼Œè¿˜ä»¥ç±»ä¼¼YouTubeé‚£æ ·æŠŠå£°éŸ³ç¿»è¯‘æˆå­—å¹•
    7. æ–¹ä¾¿è¿›è¡Œè§†é¢‘ç»†èŠ‚çš„ä¿®æ”¹ï¼Œä¾‹å¦‚æ˜¾ç¤ºçš„å†…å®¹è¿›è¡Œè„±æ•ï¼Œç”Ÿæˆçƒ­åŠ›å›¾ç­‰
    8. è®°å½•çš„åºåˆ—åŒ–æ•°æ®ï¼Œååˆ†åˆ©äºçŸ¥ä¹è¿›è¡Œæ•°æ®åˆ†æ   
        ...


é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šä¸ºä»€ä¹ˆè¦å¯¹ç½‘é¡µå½•åƒï¼Ÿæœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ

æˆ‘èƒ½æƒ³åˆ°çš„ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢

1. å¼‚å¸¸ç›‘æ§ç³»ç»Ÿï¼Œä¾‹å¦‚[LogRocket](https://logrocket.com/)ï¼Œå¯ä»¥ç†è§£ä»–æ˜¯ä¸€ä¸ªæ•´åˆäº†Sentry + å½•å±å™¨çš„å·¥å…·ï¼Œèƒ½å›æ”¾ç½‘é¡µé”™è¯¯æ—¶çš„å›¾å½¢ç•Œé¢ä¸æ•°æ®æ—¥å¿—ï¼Œä»è€Œå¸®åŠ©Debug
2. è®°å½•ç”¨æˆ·çš„è¡Œä¸ºè¿›è¡Œåˆ†æï¼Œä¾‹å¦‚[MouseFlow](https://mouseflow.com/)ã€‚ç”šè‡³è¿˜å¯ä»¥æ˜¯ç›´æ’­çš„æ–¹å¼[LiveSession](https://livesession.io/)ï¼Œâ€œè¿æ¥â€åˆ°ç”¨æˆ·çš„æµè§ˆä¸­ï¼Œçœ‹çœ‹ç”¨æˆ·æ˜¯æ€ä¹ˆä½¿ç”¨ç½‘ç«™çš„
3. å¯¹å®¢æœäººå‘˜çš„ç›‘æ§ï¼Œä¾‹å¦‚é˜¿é‡Œçš„æœ‰åä¸‡çº§åˆ«çš„å®¢æœå°äºŒäººå‘˜åˆ†æ•£åœ¨å…¨å›½å„åœ°ï¼Œéœ€è¦å¯¹ä»–ä»¬çš„æœåŠ¡è¿‡ç¨‹è¿›è¡Œ7x24å°æ—¶çš„å½•å±ï¼Œåœ¨è¿™ä¸ªæ•°é‡çº§ä¸Šçš„å¯¹ç›‘æ§çš„æ€§èƒ½è¦æ±‚å°±éå¸¸é«˜äº†ï¼Œé˜¿é‡Œå†…éƒ¨çš„å·¥å…·å«`XReplay`
4. ååŒå·¥å…·ï¼ŒWebç›´æ’­ç­‰ï¼Œä¹Ÿä¼šæ¶‰åŠç±»ä¼¼çš„æŠ€æœ¯

....

---
### Webå½•å±å™¨çš„æŠ€æœ¯ç»†èŠ‚

![Architecture](./assets/architecture.png)

#### å¯¹DOMè¿›è¡Œå¿«ç…§

é€šè¿‡DOMçš„APIå¯ä»¥å¾ˆè½»æ˜“çš„æ‹¿åˆ°é¡µé¢çš„èŠ‚ç‚¹æ•°æ®ï¼Œä½†æ˜¯å¯¹äºæˆ‘ä»¬çš„éœ€æ±‚è€Œè¨€ï¼Œæ˜¾è€ŒDOM Nodeæä¾›çš„æ•°æ®å¤ªå†—ä½™äº†ï¼Œè¿™ä¸€æ­¥é€šè¿‡å‚è€ƒVirtualDomçš„è®¾è®¡ï¼ŒæŠŠä¿¡æ¯ç²¾ç®€ä¸€ä¸‹

```ts
interface VNode {
    type: number
    id: number
    tag: string
    attrs: Attrs
    children: VNode[]
    extra: Extra
}
```

å¯¹DOMè¿›è¡Œæ·±åº¦éå†åï¼ŒDOMè¢«æ˜ å°„æˆäº†VNodeç±»å‹èŠ‚ç‚¹ï¼Œéœ€è¦è®°å½•çš„ Node ä¸»è¦æ˜¯ä¸‰ç§ç±»å‹ `ELEMENT_NODE`ï¼Œ`COMMENT_NODE`å’Œ `TEXT_NODE`ï¼Œä¹‹ååœ¨æ’­æ”¾æ—¶ï¼Œåªéœ€è¦å¯¹VNodeè¿›è¡Œè§£æï¼Œå°±å¯ä»¥è¿˜åŸæˆè®°å½•æ—¶çš„çŠ¶æ€äº†

åœ¨è¿™è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€äº›èŠ‚ç‚¹å’Œå±æ€§éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œä¾‹å¦‚

- `InputElement`ç­‰ç±»å‹çš„`value` `checked`æ˜¯æ— æ³•ä»DOMè·å–çš„ï¼Œéœ€è¦ä»èŠ‚ç‚¹ä¸­å¯¹è±¡ä¸­è·å–
- `script`æ ‡ç­¾çš„å†…å®¹ç”±äºä¹‹åä¸ä¼šå»æ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥`skip`æˆ–è€…æ ‡è®°ä¸º`noscript`
- `SVG`å¯ä»¥ç›´æ¥è·å–ï¼Œä½†æ˜¯å®ƒæœ¬èº«ä»¥åŠå®ƒçš„å­å…ƒç´ é‡æ–°è½¬æ¢ä¸ºDOMçš„æ—¶å€™éœ€è¦ä½¿ç”¨`createElementNS("http://www.w3.org/2000/svg", tagName)`çš„æ–¹æ³•åˆ›å»ºå…ƒç´ 
- `src`æˆ–`href`å±æ€§å¦‚æœæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œéœ€è¦æŠŠä»–ä»¬è½¬æ¢ä¸ºç»å¯¹è·¯å¾„
  ......

#### è®°å½•å½±å“é¡µé¢å…ƒç´ å˜åŒ–çš„Action

DOMçš„å˜åŒ–å¯ä»¥ä½¿ç”¨`MutationObserver`, ç›‘å¬åˆ°`attributes`,`characterData`,`childList` ä¸‰ç§ç±»å‹çš„å˜åŒ–
```ts
const observer = new MutationObserver((mutationRecords, observer) => {
    // Record the data
})
observer.observe(target, options)
```

å†å€ŸåŠ©`WindowEventHandlers` `addEventListener` ç­‰çš„èƒ½åŠ›ç»„åˆï¼Œå°±å¯ä»¥ç›‘å¬åˆ°é¡µé¢ä¸€ç³»åˆ—çš„æ“ä½œäº‹ä»¶äº†
- Add Node Action
- Delete Node Action
- Change Attribute Action
- Scroll Action
- Change Location Action
...

é€šè¿‡ `mouseMove` å’Œ `click` äº‹ä»¶è®°å½•é¼ æ ‡åŠ¨ä½œ 

å¯¹äº `mouseMove` äº‹ä»¶ï¼Œåœ¨ç§»åŠ¨çš„è¿‡ç¨‹ä¸­ä¼šé¢‘ç¹çš„è§¦å‘ï¼Œäº§ç”Ÿå¾ˆå®¹å†—ä½™çš„æ•°æ®ï¼Œè¿™æ ·çš„æ•°æ®ä¼šæµªè´¹å¾ˆå¤šçš„ç©ºé—´ï¼Œå› æ­¤å¯¹äºé¼ æ ‡çš„è½¨è¿¹ï¼Œæˆ‘ä»¬åªé‡‡é›†å°‘é‡çš„å…³é”®ç‚¹ï¼Œæœ€ç®€å•çš„åŠæ³•æ˜¯ä½¿ç”¨èŠ‚æµæ¥å‡å°äº‹ä»¶äº§ç”Ÿçš„æ•°æ®é‡ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼š 

- æˆªæµçš„é—´éš”ä¸­å¯èƒ½ä¼šä¸¢å¤±å…³é”®çš„é¼ æ ‡åæ ‡æ•°æ®   
- å³æ—¶é€šè¿‡æˆªæµåœ¨ç§»åŠ¨è·ç¦»è¶³å¤Ÿé•¿çš„æ—¶å€™ä»»ç„¶ä¼šäº§ç”Ÿå·¨å¤§çš„æ•°æ®é‡ï¼Œæ›´å¥½çš„åŠæ³•æ˜¯é€šè¿‡ `Spline Curves(æ ·æ¡æ›²çº¿)` å‡½æ•°æ¥è®¡ç®—å¾—å‡ºç§»åŠ¨è½¨è¿¹ã€æŠ–åŠ¨ã€åŠ é€Ÿåº¦ç­‰ç”Ÿæˆä¸€æ¡è·¯å¾„æ›²çº¿ç”¨æ¥æ§åˆ¶é¼ æ ‡çš„ç§»åŠ¨   

Inputçš„å˜æ¢æˆ‘ä»¬å¯ä»¥é€šè¿‡`Node.addEventListener` çš„ `input` `blur` `focus` äº‹ä»¶ç›‘å¬ï¼Œä¸è¿‡è¿™åªèƒ½ç›‘å¬åˆ°ç”¨æˆ·çš„è¡Œä¸ºï¼Œå¦‚æœæ˜¯é€šè¿‡JavaScriptå¯¹æ ‡ç­¾è¿›è¡Œèµ‹å€¼ï¼Œæˆ‘ä»¬æ˜¯ç›‘å¬ä¸åˆ°æ•°æ®çš„å˜åŒ–çš„ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡`Object.defineProperty`æ¥å¯¹ä¸€äº›è¡¨å•å¯¹è±¡çš„ç‰¹æ®Šå±æ€§è¿›è¡ŒåŠ«æŒï¼Œåœ¨ä¸å½±å“ç›®æ ‡èµ‹å€¼çš„æƒ…å†µä¸‹ï¼ŒæŠŠvalueæ–°å€¼è½¬å‘åˆ°è‡ªå®šçš„handleä¸Šï¼Œç»Ÿä¸€å¤„ç†çŠ¶æ€å˜åŒ–

```ts
const elementList: [HTMLElement, string][] = [
        [HTMLInputElement.prototype, 'value'],
        [HTMLInputElement.prototype, 'checked'],
        [HTMLSelectElement.prototype, 'value'],
        [HTMLTextAreaElement.prototype, 'value']
    ]

    elementList.forEach(item => {
        const [target, key] = item
        const original = Object.getOwnPropertyDescriptor(target, key)
        Object.defineProperty(target, key, {
            set: function(value: string | boolean) {
                setTimeout(() => {
                    handleEvent.call(this, key, value)
                })
                if (original && original.set) {
                    original.set.call(this, value)
                }
            }
        })
    })
```
#### MutationObserver

###### ä¼˜åŒ–æ”¹è¿›

ç”±äº DOM çš„ Diff Patch æ˜¯å€ŸåŠ© MutationObserver æ¥å®ç°çš„ï¼Œéœ€è¦å¯¹å‘ç”Ÿæ›´å˜çš„è®°å½•è¿›è¡Œæ”¶é›†å¤„ç†ï¼Œè¿™æ¶‰åŠåˆ°ä¸€äº›å…³é”®é—®é¢˜ï¼šä¾‹å¦‚DOMæ›´å˜çš„æ—¶åºæ˜¯æœ‰å…ˆåçš„ï¼ŒMutationåªå½’çº³ä¸ºæ–°å¢å’Œåˆ é™¤ï¼Œä½†æ˜¯åœ¨è°ƒç”¨insertBeforeæˆ–è€…appendChildçš„æ—¶å€™ï¼Œä¼šé€ æˆç§»åŠ¨ï¼Œè¦å¯¹è¿™äº›èŠ‚ç‚¹è¿›è¡Œå¤„ç†ï¼Œæ ‡è®°ä¸ºç§»åŠ¨ï¼Œå¦åˆ™èŠ‚ç‚¹çš„å¼•ç”¨ä¸¢å¤±å°±å¯èƒ½ä¼šå¯¼è‡´æ¸²æŸ“é”™è¯¯


###### å…¼å®¹æ€§å¤„ç†

[Can I Use MutationObserver](https://caniuse.com/#search=mutationObserver) è¡¨ç¤ºåªåœ¨IE11åŠä»¥ä¸Šï¼Œå®‰å“4.4åŠä»¥ä¸Šå¯ä»¥ä½¿ç”¨ï¼Œå¯¹äºè€æµè§ˆå™¨çš„å…¼å®¹å¯ä»¥é€šè¿‡[mutationobserver-shim](https://www.npmjs.com/package/mutationobserver-shim)çš„æ–¹å¼æ¥æ”¯æŒï¼Œä½†æ˜¯ä½¿ç”¨shimå¯èƒ½ä¼šå› ä¸ºæ”¶é›†çš„æ•°æ®è‡´ç²¾åº¦ä¸è¶³ä»è€Œäº§ç”Ÿä¸€äº›è‡´å‘½Bugï¼Œå¦å¤–è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯æŸäº›ç½‘ç«™å¯èƒ½ä¼šå±è”½çš„æ‰MutationObserverè¿™ä¸ªAPIï¼Œé‡åˆ°è¿™ç§æ¸…ç©ºå¯ä»¥é€šè¿‡åˆ›å»ºIframeçš„æ–¹å¼æ¥è¿˜åŸ``Native Code``

#### Canvasã€Iframeã€Videoç­‰å…ƒç´ çš„å¤„ç†

- Canvasï¼šé€šè¿‡çŒ´å­è¡¥ä¸çš„æ–¹å¼å»æ‰©å±•æˆ–ä¿®æ”¹ç›¸åº”çš„APIï¼Œä»è€Œè·å–åˆ°å¯¹åº”çš„åŠ¨ä½œ
- Iframeï¼šåœ¨éè·¨åŸŸçš„çŠ¶æ€ä¸‹ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®å†…éƒ¨çš„èŠ‚ç‚¹è¿›è¡Œå½•åˆ¶ï¼Œç±»ä¼¼çš„è¿˜æœ‰Shadow Dom
- Videoï¼šåˆ©ç”¨HTMLVideoElementè·å–å¹¶ä¸”è®°å½•è§†é¢‘çš„çŠ¶æ€ä¿¡æ¯
- Flashï¼šé€šè¿‡æˆªå±çš„æ–¹å¼è¿›è¡Œå½•åˆ¶

#### å¤–é“¾çš„å¤„ç†

åŠ è½½HTMLä»¥åä¼šå¼•ç”¨å¾ˆå¤šå¤–ç•Œçš„èµ„æºï¼Œé€šå¸¸ä¼šæœ‰å¤šç§å½¢å¼

ä¾‹å¦‚ï¼š
- ç»å¯¹è·¯å¾„ ``<img src="/xx.png" />`` 
- ç›¸å¯¹è·¯å¾„ ``<img src="./xx.png" />`` 
- ç›¸å¯¹å½“å‰pathçš„è·¯å¾„ ``<img src="xx.png" />`` 
- åè®®ç›¸å¯¹URL (The Protocol-relative URL)``<img src="//cnd.xx.png" />``
- srcsetå“åº”å¼å›¾ç‰‡ [Responsive images](https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images) ``src="www.xxx.png" srcset="www.xxx.png 1x, www.xxx.png 2x"``   
...

ä»¥ä¸Šå°±éœ€è¦ä¸€ä¸ªè½¬æ¢å™¨æ¥å¤„ç†è·¯å¾„é—®é¢˜ï¼Œåœ¨``Deserialize``é˜¶æ®µï¼ŒæŠŠä»–ä»¬è½¬æˆåŸåŸŸåä¸‹çš„ç»å¯¹è·¯å¾„æ‰èƒ½åœ¨è·¨åŸŸä¸‹æ­£å¸¸åŠ è½½
è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯å¯¹äºç¬¬ä¸‰æ–¹èµ„æºåŠ è½½ç¬¬ä¸‰æ–¹èµ„æºçš„é—®é¢˜ï¼Œè¿™å°±éœ€è¦å€ŸåŠ©æœåŠ¡å™¨æ¥è§£å†³äº†

###### CORS Error é—®é¢˜

é€šå¸¸æ˜¯ç”±äºè¢«å½•åˆ¶çš„ç½‘ç«™å¯¹èµ„æºè¿›è¡Œäº†é™åˆ¶, å¼€å¯äº†CORS Policyï¼Œè§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå¦‚æœèµ„æºå¯æ§ï¼Œå¯ä»¥æ·»åŠ ç™½åå•æˆ–è€…å¿½ç•¥ï¼Œå¦å¤–å°±æ˜¯ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼Œ 
> å‚è€ƒæ–‡ç« ï¼š[3 Ways to Fix the CORS Error](https://medium.com/@dtkatz/3-ways-to-fix-the-cors-error-and-how-access-control-allow-origin-works-d97d55946d9)


#### SPAç½‘é¡µçš„æ¸²æŸ“æ—¶é—´

åœ¨å¼€å§‹æ’­æ”¾å‰ï¼Œæˆ‘ä»¬éœ€è¦æŠŠä¹‹å‰çš„å­˜å‚¨çš„æ•°æ®è¿˜åŸæˆçœŸå®çš„DOMï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ä¼šå ç”¨ä¸€å®šçš„åŠ è½½æ—¶é—´äº§ç”Ÿç™½å±ï¼Œè¿™å–å†³äºä½ çš„æµè§ˆå™¨æ€§èƒ½ä»¥åŠå½•åˆ¶ç½‘é¡µèµ„æºæƒ…å†µï¼Œå‚è€ƒFMPï¼ˆFirst Meaningful Paintï¼‰çš„å®ç°ï¼ŒåŠ è½½è¿‡ç¨‹ä¸­å¯ä»¥é€šè¿‡ä¹‹å‰æ˜ å°„çš„æ•°æ®åŠ¨æ€ç”Ÿæˆéª¨æ¶å›¾ï¼Œç­‰å¾…FMPå‘å‡ºReadyä¿¡å·ä¹‹åå†è¿›è¡Œæ’­æ”¾

> å‚è€ƒæ–‡ç« ï¼š [Time to First Meaningful Paint](https://docs.google.com/document/d/1BR94tJdZLsin5poeet0XoTW60M0SjvOJQttKT-JK8HI/view#)

#### é€šè¿‡æ ·æ¡æ›²çº¿æ¨¡æ‹Ÿé¼ æ ‡è½¨è¿¹

ç”¨æˆ·åœ¨ç½‘é¡µä¸­ç§»åŠ¨é¼ æ ‡ä¼šäº§ç”Ÿå¾ˆå¤š`mouseMove`äº‹ä»¶ï¼Œé€šè¿‡ `const { x, y } = event.target` è·å–åˆ°äº†è½¨è¿¹çš„åæ ‡ä¸æ—¶é—´æˆ³

å‡å¦‚æˆ‘åœ¨é¡µé¢ä¸Šç”¨é¼ æ ‡åˆ’è¿‡ä¸€ä¸ªğŸ’–çš„è½¨è¿¹ï¼Œå¯èƒ½ä¼šå¾—åˆ°ä¸‹å›¾è¿™æ ·çš„åæ ‡ç‚¹
![heart1](./assets/heart1.png)

ä½†æ˜¯å¯¹äºå½•å±è¿™ä¸ªä¸šåŠ¡åœºæ™¯æ¥è¯´ï¼Œå¤§éƒ¨åˆ†åœºåˆæˆ‘ä»¬å¹¶ä¸è¦æ±‚100%è¿˜åŸç²¾ç¡®çš„é¼ æ ‡è½¨è¿¹ï¼Œæˆ‘é—¨åªä¼šå…³å¿ƒä¸¤ç§æƒ…å†µï¼š

    1. é¼ æ ‡åœ¨å“ªé‡Œç‚¹å‡»?
    2. é¼ æ ‡åœ¨å“ªé‡Œåœç•™?

é‚£ä¹ˆé€šè¿‡è¿™ä¸ªä¸¤ä¸ªç­–ç•¥å¯¹é¼ æ ‡è½¨è¿¹è¿›è¡Œç²¾ç®€åï¼Œç”»ä¸€ä¸ªğŸ’–å¤§çº¦åªéœ€è¦6ä¸ªç‚¹ï¼Œé€šè¿‡æ ·æ¡æ›²çº¿æ¥æ¨¡æ‹Ÿé¼ æ ‡çš„è™šæ‹Ÿè½¨è¿¹ï¼Œå½“ t = 0.2 çš„æ—¶å€™ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¸‹å›¾è¿™æ ·å¸¦ç€å¼§åº¦çš„è½¨è¿¹äº†

![heart2](./assets/heart2.png)

é€šè¿‡è§„åˆ™ç­›é€‰å‡ºå…³é”®ç‚¹åï¼Œåˆ©ç”¨Bæ ·æ¡æ›²çº¿è®¡ç®—å‡½æ•°ï¼ŒæŒ‰ç…§æœ€å°é—´éš”è¿›è¡Œå–æ ·å¹¶æ’å…¥æˆ‘ä»¬çš„é¼ æ ‡è·¯å¾„é˜Ÿæ‰§è¡Œåˆ—é‡Œï¼Œå½“æ¸²æŸ“æ—¶é‡ç»˜é¼ æ ‡ä½ç½®çš„æ—¶å€™ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªè¿‘ä¼¼æ›²çº¿çš„é¼ æ ‡è½¨è¿¹äº†

#### é€šè¿‡Diffå­—ç¬¦ä¸²ä¼˜åŒ–æ•°æ®é•¿åº¦

å½“æˆ‘ä»¬åœ¨ä¸€ä¸ªè¾“å…¥æ¡†ä¸­ä¸æ–­çš„æ•²å‡»å†…å®¹æ—¶ï¼Œæˆ‘ä»¬çš„Watcherå‡½æ•°ä¼šæºæºä¸æ–­çš„äº‹ä»¶å“åº”ï¼Œé€šè¿‡`Event.target.value`å¯ä»¥æ‹¿åˆ°å½“å‰`HTMLInputElement`æœ€æ–°çš„å€¼ï¼Œåˆ©ç”¨èŠ‚æµå‡½æ•°å¯ä»¥è¿‡æ»¤æ‰ä¸€äº›å†—ä½™çš„å“åº”ï¼Œä½†æ˜¯è¿˜ä¸å¤Ÿï¼Œä¾‹å¦‚åœ¨ä¸€ä¸ªTextAreaä¸­çš„æ–‡æœ¬ä¼šéå¸¸çš„é•¿é•¿é•¿é•¿é•¿ï¼Œå‡è®¾æ–‡æœ¬çš„é•¿åº¦æ˜¯nï¼Œæˆ‘ä»¬åœ¨æ–‡æœ¬åé¢æ·»åŠ äº†10ä¸ªå­—ç¬¦ï¼Œæ¯æ¬¡è¾“å…¥å“åº”1æ¬¡ï¼Œé‚£ä¹ˆå“åº”çš„é•¿åº¦æ˜¯ï¼š
> 10n + âˆ‘(k=1, n=10)

å¯è§ä¼šäº§ç”Ÿå¤§é‡çš„æ•°æ®

é€šè¿‡ Diff Patch ä¹‹åï¼ŒæŠŠå­—ç¬¦ä¸²`abcd` ä¿®æ”¹ `bcde`å¯ä»¥è¡¨è¾¾ä¸ºï¼š

> <h3><del>a</del>bcd<ins>e</ins></h3>

```ts
const patches = [
    { type: 'delete', index: 0, count: 1 },
    { type: 'add', index: 3, value: 'e' }
]
```

#### é€šè¿‡é¼ æ ‡æ•°æ®ç”Ÿæˆçƒ­åŠ›å›¾

ä¹‹å‰å·²ç»é€šè¿‡é¼ æ ‡äº‹ä»¶è®°å½•äº†å®Œæ•´çš„åæ ‡ä¿¡æ¯ï¼Œé€šè¿‡[heatmap.js](https://www.patrick-wied.at/static/heatmapjs/)å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç”Ÿæˆçƒ­åŠ›å›¾ï¼Œç”¨äºå¯¹ç”¨æˆ·çš„è¡Œä¸ºæ•°æ®è¿›è¡Œåˆ†æã€‚

è¿™é‡Œéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯å½“é¡µé¢åˆ‡æ¢çš„æ—¶å€™æˆ‘ä»¬éœ€è¦é‡ç½®çƒ­åŠ›å›¾ï¼Œå¦‚æœæ˜¯å•é¡µåº”ç”¨ï¼Œé€šè¿‡ `History` çš„ `popstate` ä¸ `hashchange` å¯ä»¥ç›‘å¬é¡µé¢çš„å˜åŒ–

![heatmap](./assets/heatmap.png)

#### å¯¹äºç”¨æˆ·éšç§çš„è„±æ•

å¯¹äºä¸€äº›å®¢æˆ·ä¸ªäººéšç§æ•°æ®ï¼Œé€šè¿‡åœ¨å¼€å‘æ—¶å¯¹DOMè¿›è¡Œæ ‡æ³¨çš„ `Node.COMMENT_NODE`ï¼ˆä¾‹å¦‚ï¼š `<!-- ... -->`ï¼‰ä¿¡æ¯ç”³æ˜ï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥è·å–å¹¶åŠ å·¥çš„ã€‚é€šè¿‡çº¦å®šå¥½çš„å£°æ˜å¯¹éœ€è¦è„±æ•çš„DOMå—æŒ‰ä¸šåŠ¡çš„éœ€æ±‚è¿›è¡Œå¤„ç†å³å¯ï¼Œä¾‹å¦‚åœ¨é¡¹ç›®çš„DEMOä¸­ï¼Œæˆ‘éœ€è¦åœ¨å›æ”¾çš„æ—¶å€™æŠŠ```<button>```æ ‡ç­¾éšè—æ‰ï¼Œåªéœ€æ”¹å†™æˆ```<!--hidden--><button>```

#### æ²™ç®±åŒ–æå‡å®‰å…¨

å½•åˆ¶çš„å†…å®¹æœ‰å¯èƒ½å±äºç¬¬ä¸‰æ–¹æä¾›ï¼Œè¿™æ„å‘³ç€å¯èƒ½å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç½‘ç«™ä¸­å¯èƒ½æœ‰ä¸€äº›æ¶æ„çš„è„šæœ¬å¹¶æ²¡æœ‰è¢«æˆ‘ä»¬å®Œå…¨è¿‡æ»¤æ‰ï¼Œä¾‹å¦‚ï¼š`<div onload="alert('something'); script..."></div>`ï¼Œæˆ–è€…æˆ‘ä»¬çš„æ’­æ”¾å™¨ä¸­çš„ä¸€äº›äº‹ä»¶ä¹Ÿå¯èƒ½å¯¹æ’­æ”¾å†…å®¹äº§ç”Ÿå½±å“ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ²™ç›’æ¥éš”ç¦»æ’­æ”¾å†…å®¹çš„ç¯å¢ƒï¼ŒHTML5 æä¾›çš„ `Sandbox` æ˜¯ä¸é”™çš„é€‰æ‹©ï¼Œè¿™å¯ä»¥å¸®åŠ©æˆ‘ä»¬è½»æ˜“çš„éš”ç¦»ç¯å¢ƒï¼š
- scriptè„šæœ¬ä¸èƒ½æ‰§è¡Œ
- ä¸èƒ½å‘é€ajaxè¯·æ±‚
- ä¸èƒ½ä½¿ç”¨æœ¬åœ°å­˜å‚¨ï¼Œå³localStorage,cookieç­‰
- ä¸èƒ½åˆ›å»ºæ–°çš„å¼¹çª—å’Œwindow, æ¯”å¦‚window.open or target="_blank"
- ä¸èƒ½å‘é€è¡¨å•
- ä¸èƒ½åŠ è½½é¢å¤–æ’ä»¶æ¯”å¦‚flashç­‰
- ä¸èƒ½æ‰§è¡Œè‡ªåŠ¨æ’­æ”¾çš„tricky. æ¯”å¦‚: autofocused, autoplay

#### æ’­æ”¾ã€è·³è½¬ä¸å¿«è¿›

##### æ’­æ”¾
æ’­æ”¾å™¨ä¼šå†…ç½®ä¸€ä¸ªç²¾ç¡®çš„è®¡æ—¶å™¨ï¼ŒåŠ¨ä½œçš„æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªæ ˆä¸­ï¼Œæ ˆä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡å°±æ˜¯ä¸€å¸§ï¼Œé€šè¿‡`RAF(RequestAnimationFrame)`å¯¹æ•°æ®å¸§çš„æ—¶é—´æˆ³è¿›è¡Œæ‰«æä»è€Œå¾—çŸ¥ä¸‹ä¸€å¸§åœ¨ä»€ä¹ˆæ—¶é—´å‘ç”Ÿ

##### æš‚åœ
é€šè¿‡`CancelAnimationFrame`æš‚åœè®¡æ—¶å™¨

##### å¿«è¿›
åŠ é€Ÿæ¸²æŸ“å¸§çš„é€Ÿç‡

##### åŒå‘è·³è½¬
è·³è½¬æ˜¯ä¸ªå¤æ‚çš„é—®é¢˜ï¼Œå¦‚æœè¦å®ç°åƒè§†é¢‘é‚£æ ·å¯ä»¥å‘å‰ä¸å‘åçš„åŒå‘è·³è½¬ï¼Œç”±äºå—åˆ°æ¸²æŸ“å¼•æ“çš„çº¦æŸï¼Œæˆ‘å¹¶æ²¡æœ‰å®ç°å‡ºä¸€ä¸ªåå‘æ¸²æŸ“çš„æ–¹æ³•ï¼Œè€Œæ˜¯é€šè¿‡ç‰¹æ®Šçš„åŠæ³•æ¥è§£å†³
>å‚è€ƒæ–‡ç« ï¼š[ä¸ºä»€ä¹ˆå¤§å¤šæ•°æ¸¸æˆçš„å›æ”¾åŠŸèƒ½éƒ½ä¸èƒ½å€’æ”¾æˆ–è€…è·³è·ƒè¿›åº¦ï¼Ÿ](https://www.zhihu.com/question/309668627)

è¦å®ç°åŒå‘è·³è½¬ï¼Œè¿™é‡Œçš„æ€è·¯æ˜¯åœ¨å†…å­˜ä¸­æŒ‰ç…§ä¸€å®šçš„è·ç¦»è®¡ç®—å‡ºç›¸åº”çš„ `S (Snapshot)` ä¸ `A (Action)`

| _S_ | `A` | `A` | `A` | _S_ | `A` | `A` | _S_ | `A` | `A` | `A` | ...... |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | ------ |

äºæ˜¯`[SAAA]`å½¢æˆäº†ä¸€ä¸ªåŒºå—ï¼Œå‘ç”Ÿè·³è½¬è¡Œä¸ºæ—¶ï¼Œä¼šå®šä½åˆ°ç›¸åº”çš„åŒºå—ä¸­è¿›è¡Œè®¡ç®—åå¹¶æ¸²æŸ“

#### å½•åˆ¶éŸ³é¢‘ä¸ç”Ÿæˆå­—å¹•

é€šè¿‡HTML5æä¾›çš„`WebRTC`æ¥å£å¯ä»¥è¿›è¡ŒéŸ³é¢‘å½•åˆ¶ï¼Œç”±äºä¸»è¦æ˜¯å½•åˆ¶äººå£°è¯­éŸ³ï¼Œæ‰€ä»¥å¯¹äºå½•åˆ¶å“è´¨è¦æ±‚å¹¶ä¸é«˜ï¼Œè¿™é‡Œæˆ‘é€‰ç”¨äº†8000çš„é‡‡æ ·ç‡å’Œ8æ¯”ç‰¹ç‡å•å£°é“çš„PCMå½•åˆ¶æ ¼å¼ï¼ŒåæœŸå¯ä»¥è½¬åŒ–ä¸ºæœ‰æŸå‹ç¼©çš„`mp3`æ ¼å¼ä»¥èŠ‚çœç©ºé—´ï¼Œå­—å¹•ä¼šé€šè¿‡ä¸€äº›ç¬¬ä¸‰æ–¹æœåŠ¡åˆ†æå½•åˆ¶æ–‡ä»¶åè‡ªåŠ¨ç”Ÿæˆ

#### åœ¨å®¢æˆ·ç«¯è¿›è¡Œçš„Gzipå‹ç¼©

Gzipä¸€èˆ¬æ˜¯åœ¨ç½‘ç»œåº”ç”¨å±‚é‡Œå¯¹ä¼ è¾“æ•°æ®è¿›è¡Œå‹ç¼©ï¼Œä½†æ˜¯æˆ‘ä»¬çš„æ•°æ®ä¸ä¸€å®šåªå­˜åœ¨æ•°æ®åº“é‡Œï¼Œå¯èƒ½ä¼šæœ‰ä¸‰ç§å‚¨å­˜æ–¹å¼

- æœåŠ¡å™¨å­˜å‚¨ TCP => DB
- æœ¬åœ°å‚¨å­˜ LocalStorageã€IndexedDBã€Web SQL
- æ•°æ®æŒä¹…åŒ–äºscriptä¸­ï¼Œä¿å­˜ä¸ºæœ¬åœ°æ–‡ä»¶ï¼Œä¾‹å¦‚ç›´æ¥å¯¼å‡ºå¯è¿è¡Œçš„HTMLæ–‡ä»¶

åˆ©ç”¨å®¢æˆ·ç«¯çš„è¿ç®—èƒ½åŠ›ï¼Œåœ¨è¿›è¡Œå¯¼å‡ºæˆ–è€…ä¼ è¾“ä¹‹å‰ï¼Œå¯ä»¥å¯¹æ•°æ®è¿›è¡Œå‹ç¼©ï¼Œæå¤§ç¨‹åº¦çš„å‡å°ä½“ç§¯

åœ¨å®¢æˆ·ç«¯å¯ä»¥è¿›è¡ŒåŸºäº `Gzip` çš„æ•°æ®åŒ…å‹ç¼©ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©äº† [Pako](https://nodeca.github.io/pako/) æ¥å¯¹æ•°æ®è¿›è¡Œå‹ç¼©   
Gzipçš„æ ¸å¿ƒæ˜¯Deflate, è€ŒDeflateåˆæ˜¯åŸºäºLZ77å’Œå“ˆå¤«æ›¼æ ‘çš„ï¼Œé€šè¿‡GzipæŠŠæ–‡æœ¬æ•°æ®è½¬æ¢æˆ`Uint8Array`, å†æŠŠ`Uint8`è½¬æˆå¯¹åº”çš„`ASCII`ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯æ¯ä¸€ä¸ªç¼–ç åªä¼šå ç”¨`1byte`çš„ç©ºé—´ï¼Œé€šè¿‡å‹ç¼©å‡å°‘çº¦`5`å€å·¦å³çš„ä½“ç§¯

#### æ•°æ®ä¸Šä¼ 

å¯¹äºå®¢æˆ·ç«¯çš„æ•°æ®ï¼Œå¯ä»¥åˆ©ç”¨æµè§ˆå™¨æä¾›çš„indexedDBè¿›è¡Œå­˜å‚¨ï¼Œæ¯•ç«ŸindexedDBä¼šæ¯”LocalStorageå®¹é‡å¤§å¾—å¤šï¼Œä¸€èˆ¬æ¥è¯´ä¸å°‘äº 250MBï¼Œç”šè‡³æ²¡æœ‰ä¸Šé™ï¼Œæ­¤å¤–å®ƒä½¿ç”¨object storeå­˜å‚¨ï¼Œè€Œä¸”æ”¯æŒtransactionï¼Œå¦å¤–å¾ˆé‡è¦çš„ä¸€ç‚¹å®ƒæ˜¯å¼‚æ­¥çš„ï¼Œæ„å‘³ç€ä¸ä¼šé˜»å¡å½•å±å™¨çš„è¿è¡Œï¼Œä¹‹åæ•°æ®å¯ä»¥é€šè¿‡WebSocketæˆ–httpæ–¹å¼æŒç»­ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸­ï¼Œç”±äºæ•°æ®æ˜¯åˆ†å—è¿›è¡Œä¼ è¾“çš„ï¼Œåœ¨åŒæ­¥ä¹‹åè¿˜å¯ä»¥å¢åŠ æ•°æ®æ ¡éªŒç æ¥ä¿è¯ä¸€è‡´æ€§é¿å…é”™è¯¯

#### åŠ è½½SDK

é€šè¿‡RollUpæ‰“åŒ…å™¨å¯ä»¥ç”Ÿæˆå¤šç§æ ¼å¼ç‰ˆæœ¬ï¼Œä¾‹å¦‚``UMD``ä¸``ESM``ç­‰
åœ¨é¡¹ç›®ä¸­åŠ è½½SDKæˆ–è€…åˆ©ç”¨Chromeçš„æ’ä»¶æ³¨å…¥UMDæ¨¡å—ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„åŠ è½½ä»£ç ï¼Œæ§åˆ¶æ•°æ®å½•åˆ¶çš„è¿‡ç¨‹

#### è‡´è°¢

æ„Ÿè°¢é˜¿é‡Œçš„XREPLAYçš„å¯å‘   
æ„Ÿè°¢RRWEBçš„æŠ€æœ¯åˆ†äº«   

#### å¯»æ±‚å·¥ä½œæœºä¼š

å¦‚æœ‰ä¼¯ä¹
è‹¥ä¸ä»‹æ„å­¦å†å› ç´ 
è¯·ä¸æˆ‘è”ç³»ï¼š

å¾®ä¿¡ï¼š
```js
62809912 >> 2
```
é‚®ç®±ï¼šè§Githubä¸ªäººä¸»é¡µ
èŒä½ï¼šå‰ç«¯å·¥ç¨‹å¸ˆ
æ–¹å‘ï¼šåº”ç”¨å·¥å…·/å¤§å‹ç½‘ç«™
åœ°ç‚¹ï¼šå¤©å—æµ·åŒ—
